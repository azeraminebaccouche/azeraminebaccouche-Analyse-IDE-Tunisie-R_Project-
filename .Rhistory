values_to = "Companies"
)
# --- PART 2: CLEAN "JOBS" (For the Sector Analysis) ---
# Load data (Exportatrices, Autre columns...)
df_jobs <- read_excel("emploientreprisesetrangere.xls", skip = 0)
# Clean it up based on your screenshot
final_jobs_data <- df_jobs %>%
rename(Sector = 1) %>%        # First column is 'ActivitÃ©s' -> rename to Sector
select(Sector, `Totalement Exportatrices`, AUTRE) %>% # Keep only relevant columns
filter(!is.na(Sector)) %>%
filter(Sector != "Total") %>%
# Make it long for Power BI charts
pivot_longer(
cols = -Sector,
names_to = "Company_Type",  # 'Totalement Exportatrices' or 'AUTRE'
values_to = "Jobs"
)
# --- PART 3: EXPORT TO CSV ---
write_csv(final_map_data, "tunisia_investment_map.csv")
write_csv(final_jobs_data, "tunisia_jobs_sectors.csv")
print("Files created: tunisia_investment_map.csv AND tunisia_jobs_sectors.csv")
View(clean_df)
View(final_map_data)
View(final_jobs_data)
df_jdid <- read_excel("repartitionentreprisesetrangere.xls", skip = 0)
View(df_jdid)
View(df_countries)
# --- 1. PREPARE DATA FOR STATISTICS ---
# We need to merge your two files to see the relation between Investment and Jobs.
# Load the clean files we made earlier
df_invest <- read_csv("tunisia_investment_map.csv")
library(readxl)
library(tidyverse)
df_countries <- read_excel("repartitionentreprisesetrangereparpays.xls", skip = 0)
df_jobs <- read_excel("emploientreprisesetrangere.xls", skip = 0)
View(df_countries)
df_countries <- read_excel("repartitionentreprisesetrangereparpays.xls", skip = 0)
clean_df <- df_countries %>%
rename(Sector = 1) %>%
filter(!is.na(Sector))
final_data <- clean_df %>%
pivot_longer(
cols = -Sector,
names_to = "Country",
values_to = "Companies"
)
write_csv(final_data, "tunisia_investment_powerbi.csv")
View(final_data)
df_countries <- read_excel("repartitionentreprisesetrangereparpays.xls", skip = 0)
final_map_data <- df_countries %>%
rename(Sector = 1) %>%
filter(!is.na(Sector)) %>%
filter(Sector != "Total") %>%
pivot_longer(
cols = -Sector,
names_to = "Country",
values_to = "Companies"
)
df_jobs <- read_excel("emploientreprisesetrangere.xls", skip = 0)
final_jobs_data <- df_jobs %>%
rename(Sector = 1) %>%
select(Sector, `Totalement Exportatrices`, AUTRE) %>%
filter(!is.na(Sector)) %>%
filter(Sector != "Total") %>%
pivot_longer(
cols = -Sector,
names_to = "Company_Type",
values_to = "Jobs"
)
write_csv(final_map_data, "tunisia_investment_map.csv")
write_csv(final_jobs_data, "tunisia_jobs_sectors.csv")
library(tidyverse)
library(readxl)
# --- 1. PREPARE DATA FOR STATISTICS ---
# We need to merge your two files to see the relation between Investment and Jobs.
# Load the clean files we made earlier
df_invest <- read_csv("tunisia_investment_map.csv")
df_labor  <- read_csv("tunisia_jobs_sectors.csv")
# Group by SECTOR to get totals for analysis
stats_data <- df_invest %>%
group_by(Sector) %>%
summarise(Total_Companies = sum(Companies)) %>%
left_join(
df_labor %>% group_by(Sector) %>% summarise(Total_Jobs = sum(Jobs)),
by = "Sector"
)
library(tidyverse)
library(readxl)
# --- 1. LOAD DATA ---
df_invest <- read_csv("tunisia_investment_map.csv", show_col_types = FALSE)
df_labor  <- read_csv("tunisia_jobs_sectors.csv", show_col_types = FALSE)
# --- 2. CLEANING (THE FIX) ---
# We force 'Companies' and 'Jobs' to be numbers.
# gsub(" ", "", ...) removes any hidden spaces (like "1 053" -> "1053")
df_invest <- df_invest %>%
mutate(Companies = as.numeric(gsub("\\s", "", Companies)))
df_labor <- df_labor %>%
mutate(Jobs = as.numeric(gsub("\\s", "", Jobs)))
# --- 3. PREPARE DATA FOR STATISTICS ---
# Now sum() will work because they are numbers!
stats_data <- df_invest %>%
group_by(Sector) %>%
summarise(Total_Companies = sum(Companies, na.rm = TRUE)) %>%
left_join(
df_labor %>% group_by(Sector) %>% summarise(Total_Jobs = sum(Jobs, na.rm = TRUE)),
by = "Sector"
)
print(stats_data)
# =========================================================
# STATISTICAL ANALYSIS (The Notebook Requirements)
# =========================================================
# --- Q1: Mean, Median, Variance ---
mean_jobs <- mean(stats_data$Total_Jobs, na.rm = TRUE)
median_jobs <- median(stats_data$Total_Jobs, na.rm = TRUE)
var_jobs <- var(stats_data$Total_Jobs, na.rm = TRUE)
print(paste("Mean Jobs per Sector:", round(mean_jobs, 2)))
print(paste("Median Jobs:", round(median_jobs, 2)))
# --- Q2: Normality Test (Shapiro-Wilk) ---
shapiro_result <- shapiro.test(stats_data$Total_Jobs)
library(readxl)
library(tidyverse)
df_countries <- read_excel("repartitionentreprisesetrangereparpays.xls", skip = 0)
df_jobs <- read_excel("emploientreprisesetrangere.xls", skip = 0)
View(df_countries)
df_countries <- read_excel("repartitionentreprisesetrangereparpays.xls", skip = 0)
clean_df <- df_countries %>%
rename(Sector = 1) %>%
filter(!is.na(Sector))
final_data <- clean_df %>%
pivot_longer(
cols = -Sector,
names_to = "Country",
values_to = "Companies"
)
write_csv(final_data, "tunisia_investment_powerbi.csv")
View(final_data)
df_countries <- read_excel("repartitionentreprisesetrangereparpays.xls", skip = 0)
final_map_data <- df_countries %>%
rename(Sector = 1) %>%
filter(!is.na(Sector)) %>%
filter(Sector != "Total") %>%
pivot_longer(
cols = -Sector,
names_to = "Country",
values_to = "Companies"
)
df_jobs <- read_excel("emploientreprisesetrangere.xls", skip = 0)
final_jobs_data <- df_jobs %>%
rename(Sector = 1) %>%
select(Sector, `Totalement Exportatrices`, AUTRE) %>%
filter(!is.na(Sector)) %>%
filter(Sector != "Total") %>%
pivot_longer(
cols = -Sector,
names_to = "Company_Type",
values_to = "Jobs"
)
write_csv(final_map_data, "tunisia_investment_map.csv")
write_csv(final_jobs_data, "tunisia_jobs_sectors.csv")
library(tidyverse)
library(readxl)
# --- 1. LOAD DATA ---
df_invest <- read_csv("tunisia_investment_map.csv", show_col_types = FALSE)
df_labor  <- read_csv("tunisia_jobs_sectors.csv", show_col_types = FALSE)
# --- 2. CLEANING (THE FIX) ---
# We force 'Companies' and 'Jobs' to be numbers.
# gsub(" ", "", ...) removes any hidden spaces (like "1 053" -> "1053")
df_invest <- df_invest %>%
mutate(Companies = as.numeric(gsub("\\s", "", Companies)))
df_labor <- df_labor %>%
mutate(Jobs = as.numeric(gsub("\\s", "", Jobs)))
# --- 3. PREPARE DATA FOR STATISTICS ---
# Now sum() will work because they are numbers!
stats_data <- df_invest %>%
group_by(Sector) %>%
summarise(Total_Companies = sum(Companies, na.rm = TRUE)) %>%
left_join(
df_labor %>% group_by(Sector) %>% summarise(Total_Jobs = sum(Jobs, na.rm = TRUE)),
by = "Sector"
)
print(stats_data)
# =========================================================
# STATISTICAL ANALYSIS (The Notebook Requirements)
# =========================================================
# --- Q1: Mean, Median, Variance ---
mean_jobs <- mean(stats_data$Total_Jobs, na.rm = TRUE)
median_jobs <- median(stats_data$Total_Jobs, na.rm = TRUE)
var_jobs <- var(stats_data$Total_Jobs, na.rm = TRUE)
print(paste("Mean Jobs per Sector:", round(mean_jobs, 2)))
print(paste("Median Jobs:", round(median_jobs, 2)))
# --- Q2: Normality Test (Shapiro-Wilk) ---
shapiro_result <- shapiro.test(stats_data$Total_Jobs)
library(readxl)
library(tidyverse)
# =========================================================
# PART 2: DATA CLEANING & TRANSFORMATION (ETL)
# =========================================================
# --- A. CLEAN THE INVESTMENT DATA (Map) ---
# Load the file
df_countries <- read_excel("repartitionentreprisesetrangereparpays.xls", skip = 0)
# Transform for Power BI
final_map_data <- df_countries %>%
rename(Sector = 1) %>%          # Rename first column
filter(!is.na(Sector)) %>%      # Remove empty rows
filter(Sector != "Total") %>%   # Remove "Total" row
pivot_longer(
cols = -Sector,               # Keep Sector, pivot countries
names_to = "Country",
values_to = "Companies"
) %>%
# FIX: Ensure Companies is a number (removes spaces if any)
mutate(Companies = as.numeric(gsub("\\s", "", Companies)))
# --- B. CLEAN THE JOBS DATA (Sectors) ---
# Load the file
df_jobs <- read_excel("emploientreprisesetrangere.xls", skip = 0)
# Transform for Power BI
final_jobs_data <- df_jobs %>%
rename(Sector = 1) %>%          # Rename first column
select(Sector, `Totalement Exportatrices`, AUTRE) %>% # Select specific columns
filter(!is.na(Sector)) %>%
filter(Sector != "Total") %>%
pivot_longer(
cols = -Sector,
names_to = "Company_Type",    # 'Totalement Exportatrices' or 'AUTRE'
values_to = "Jobs"
) %>%
# FIX: Ensure Jobs is a number
mutate(Jobs = as.numeric(gsub("\\s", "", Jobs)))
# =========================================================
# PART 3: EXPORT TO CSV (For Power BI)
# =========================================================
write_csv(final_map_data, "tunisia_investment_map.csv")
write_csv(final_jobs_data, "tunisia_jobs_sectors.csv")
print("Files successfully created for Power BI.")
# =========================================================
# PART 4: STATISTICAL ANALYSIS (For the Project Report)
# =========================================================
# --- Prepare Data for Statistics ---
# We aggregate by Sector to compare Investment vs. Jobs
stats_data <- final_map_data %>%
group_by(Sector) %>%
summarise(Total_Companies = sum(Companies, na.rm = TRUE)) %>%
left_join(
final_jobs_data %>% group_by(Sector) %>% summarise(Total_Jobs = sum(Jobs, na.rm = TRUE)),
by = "Sector"
)
print("Data prepared for statistics:")
print(stats_data)
# --- Q1: Mean, Median, Variance ---
mean_jobs <- mean(stats_data$Total_Jobs, na.rm = TRUE)
median_jobs <- median(stats_data$Total_Jobs, na.rm = TRUE)
var_jobs <- var(stats_data$Total_Jobs, na.rm = TRUE)
print(paste("Mean Jobs per Sector:", round(mean_jobs, 2)))
print(paste("Median Jobs:", round(median_jobs, 2)))
print(paste("Variance:", round(var_jobs, 2)))
# --- Q2: Normality Test (Shapiro-Wilk) ---
# Checks if the data follows a normal bell curve
shapiro_result <- shapiro.test(stats_data$Total_Jobs)
# --- 1. LOAD DATA ---
df_countries <- read_excel("repartitionentreprisesetrangereparpays.xls", skip = 0)
df_jobs <- read_excel("emploientreprisesetrangere.xls", skip = 0)
# --- 2. CLEAN INVESTMENT DATA (Map) ---
final_map_data <- df_countries %>%
rename(Sector = 1) %>%
filter(!is.na(Sector)) %>%
filter(Sector != "Total") %>%
# CLEANING: Trim spaces from Sector names
mutate(Sector = trimws(Sector)) %>%
pivot_longer(cols = -Sector, names_to = "Country", values_to = "Companies") %>%
# CLEANING: Force numbers
mutate(Companies = as.numeric(gsub("[[:space:]]", "", Companies)))
# --- 3. CLEAN JOBS DATA (Sectors) ---
final_jobs_data <- df_jobs %>%
rename(Sector = 1) %>%
select(Sector, `Totalement Exportatrices`, AUTRE) %>%
filter(!is.na(Sector)) %>%
filter(Sector != "Total") %>%
# CLEANING: Trim spaces from Sector names so they match the other file
mutate(Sector = trimws(Sector)) %>%
pivot_longer(cols = -Sector, names_to = "Company_Type", values_to = "Jobs") %>%
# CLEANING: Force numbers (Handle '1 053' with hard space)
mutate(Jobs = as.numeric(gsub("[[:space:]]", "", Jobs)))
# --- 4. MERGE FOR STATISTICS ---
stats_data <- final_map_data %>%
group_by(Sector) %>%
summarise(Total_Companies = sum(Companies, na.rm = TRUE)) %>%
left_join(
final_jobs_data %>% group_by(Sector) %>% summarise(Total_Jobs = sum(Jobs, na.rm = TRUE)),
by = "Sector"
)
# --- DEBUG: CHECK DATA ---
# This will show you what the data looks like.
# If Total_Jobs are all 0, the Shapiro test will fail.
print("Here is your data for the test:")
print(stats_data)
# --- 5. RUN THE TESTS (Only if data is valid) ---
# Check if we have variance (Variance must not be 0)
if(var(stats_data$Total_Jobs, na.rm=TRUE) == 0) {
print("ERROR: All Job numbers are identical (probably 0). Check the 'clean' step.")
} else {
# Q1: Mean/Median
print(paste("Mean Jobs:", round(mean(stats_data$Total_Jobs, na.rm=TRUE), 2)))
# Q2: Shapiro Test
print("Shapiro-Wilk Test:")
print(shapiro.test(stats_data$Total_Jobs))
# Q4: Correlation
print(paste("Correlation:", cor(stats_data$Total_Companies, stats_data$Total_Jobs, use="complete.obs")))
# Q5: Linear Model
model <- lm(Total_Jobs ~ Total_Companies, data = stats_data)
print(summary(model))
# Plot
ggplot(stats_data, aes(x = Total_Companies, y = Total_Jobs)) +
geom_point(size = 3, color = "blue") +
geom_smooth(method = "lm", color = "red") +
labs(title = "Investment vs Jobs")
}
# --- 1. LOAD DATA ---
df_countries <- read_excel("repartitionentreprisesetrangereparpays.xls", skip = 0)
df_jobs <- read_excel("emploientreprisesetrangere.xls", skip = 0)
# --- 2. CLEAN DATA (The "Nuclear" Method) ---
# Clean Map Data
final_map_data <- df_countries %>%
rename(Sector = 1) %>%
filter(!is.na(Sector)) %>%
filter(Sector != "Total") %>%
mutate(Sector = trimws(Sector)) %>%
pivot_longer(cols = -Sector, names_to = "Country", values_to = "Companies") %>%
# KEEP ONLY DIGITS (0-9). Deletes spaces, text, symbols.
mutate(Companies = as.numeric(gsub("[^0-9]", "", Companies)))
# Clean Jobs Data
final_jobs_data <- df_jobs %>%
rename(Sector = 1) %>%
select(Sector, `Totalement Exportatrices`, AUTRE) %>%
filter(!is.na(Sector)) %>%
filter(Sector != "Total") %>%
mutate(Sector = trimws(Sector)) %>%
pivot_longer(cols = -Sector, names_to = "Company_Type", values_to = "Jobs") %>%
# KEEP ONLY DIGITS (0-9).
mutate(Jobs = as.numeric(gsub("[^0-9]", "", Jobs)))
# --- 3. MERGE ---
stats_data <- final_map_data %>%
group_by(Sector) %>%
summarise(Total_Companies = sum(Companies, na.rm = TRUE)) %>%
left_join(
final_jobs_data %>% group_by(Sector) %>% summarise(Total_Jobs = sum(Jobs, na.rm = TRUE)),
by = "Sector"
)
# --- 4. VERIFY DATA (Before Testing) ---
print("--- DATA PREVIEW (Check if Total_Jobs has numbers) ---")
print(head(stats_data))
# --- 5. RUN STATISTICS ---
# A. Mean & Median
print(paste("Mean Jobs:", round(mean(stats_data$Total_Jobs, na.rm = TRUE), 2)))
print(paste("Median Jobs:", round(median(stats_data$Total_Jobs, na.rm = TRUE), 2)))
# B. Shapiro-Wilk Test (Normality)
# We use tryCatch to handle errors gracefully if data is still weird
tryCatch({
print("Shapiro-Wilk Test:")
print(shapiro.test(stats_data$Total_Jobs))
}, error = function(e) { print("Shapiro Test Error: Data might still be constant or too small.") })
# C. Correlation
cor_result <- cor(stats_data$Total_Companies, stats_data$Total_Jobs, use = "complete.obs")
print(paste("Correlation Coefficient:", round(cor_result, 4)))
# D. Linear Regression
model <- lm(Total_Jobs ~ Total_Companies, data = stats_data)
print("Linear Regression Summary:")
print(summary(model))
# E. Plot
ggplot(stats_data, aes(x = Total_Companies, y = Total_Jobs)) +
geom_point(color = "darkblue", size = 3) +
geom_smooth(method = "lm", color = "red", se = FALSE) +
theme_minimal() +
labs(title = "Final Model: Investment vs Jobs", x = "Companies", y = "Jobs")
# =========================================================
# PART 1: SETUP & LIBRARIES
# =========================================================
# (Run these lines once to install, then you can comment them out with #)
install.packages("readxl")
install.packages("readxl")
# =========================================================
# PART 1: SETUP & LIBRARIES
# =========================================================
# (Run these lines once to install, then you can comment them out with #)
install.packages("readxl")
View(clean_df)
View(df_countries)
View(clean_df)
View(df_jobs)
# =========================================================
# PART 1: SETUP & LIBRARIES
# =========================================================
# (Run these lines once to install, then you can comment them out with #)
install.packages("readxl")
install.packages("tidyverse")
library(readxl)
library(tidyverse)
# --- 1. LOAD DATA ---
df_countries <- read_excel("repartitionentreprisesetrangereparpays.xls", skip = 0)
df_jobs <- read_excel("emploientreprisesetrangere.xls", skip = 0)
# --- 2. CLEAN DATA (The "Nuclear" Method) ---
# Clean Map Data
final_map_data <- df_countries %>%
rename(Sector = 1) %>%
filter(!is.na(Sector)) %>%
filter(Sector != "Total") %>%
mutate(Sector = trimws(Sector)) %>%
pivot_longer(cols = -Sector, names_to = "Country", values_to = "Companies") %>%
# KEEP ONLY DIGITS (0-9). Deletes spaces, text, symbols.
mutate(Companies = as.numeric(gsub("[^0-9]", "", Companies)))
# Clean Jobs Data
final_jobs_data <- df_jobs %>%
rename(Sector = 1) %>%
select(Sector, `Totalement Exportatrices`, AUTRE) %>%
filter(!is.na(Sector)) %>%
filter(Sector != "Total") %>%
mutate(Sector = trimws(Sector)) %>%
pivot_longer(cols = -Sector, names_to = "Company_Type", values_to = "Jobs") %>%
# KEEP ONLY DIGITS (0-9).
mutate(Jobs = as.numeric(gsub("[^0-9]", "", Jobs)))
# --- 3. MERGE ---
stats_data <- final_map_data %>%
group_by(Sector) %>%
summarise(Total_Companies = sum(Companies, na.rm = TRUE)) %>%
left_join(
final_jobs_data %>% group_by(Sector) %>% summarise(Total_Jobs = sum(Jobs, na.rm = TRUE)),
by = "Sector"
)
# --- 4. VERIFY DATA (Before Testing) ---
print("--- DATA PREVIEW (Check if Total_Jobs has numbers) ---")
print(head(stats_data))
# --- 5. RUN STATISTICS ---
# A. Mean & Median
print(paste("Mean Jobs:", round(mean(stats_data$Total_Jobs, na.rm = TRUE), 2)))
print(paste("Median Jobs:", round(median(stats_data$Total_Jobs, na.rm = TRUE), 2)))
# B. Shapiro-Wilk Test (Normality)
# We use tryCatch to handle errors gracefully if data is still weird
tryCatch({
print("Shapiro-Wilk Test:")
print(shapiro.test(stats_data$Total_Jobs))
}, error = function(e) { print("Shapiro Test Error: Data might still be constant or too small.") })
# C. Correlation
cor_result <- cor(stats_data$Total_Companies, stats_data$Total_Jobs, use = "complete.obs")
print(paste("Correlation Coefficient:", round(cor_result, 4)))
# D. Linear Regression
model <- lm(Total_Jobs ~ Total_Companies, data = stats_data)
print("Linear Regression Summary:")
print(summary(model))
# E. Plot
ggplot(stats_data, aes(x = Total_Companies, y = Total_Jobs)) +
geom_point(color = "darkblue", size = 3) +
geom_smooth(method = "lm", color = "red", se = FALSE) +
theme_minimal() +
labs(title = "Final Model: Investment vs Jobs", x = "Companies", y = "Jobs")
#SETUP & LIBRARIES
install.packages("readxl")
install.packages("tidyverse")
library(readxl)
library(tidyverse)
# LOAD DATA
df_countries <- read_excel("repartitionentreprisesetrangereparpays.xls", skip = 0)
df_jobs <- read_excel("emploientreprisesetrangere.xls", skip = 0)
#CLEAN DATA
final_map_data <- df_countries %>%
rename(Sector = 1) %>%
filter(!is.na(Sector)) %>%
filter(Sector != "Total") %>%
mutate(Sector = trimws(Sector)) %>%
pivot_longer(cols = -Sector, names_to = "Country", values_to = "Companies") %>%
# KEEP ONLY DIGITS (0-9). Deletes spaces, text, symbols.
mutate(Companies = as.numeric(gsub("[^0-9]", "", Companies)))
# Clean Jobs Data
final_jobs_data <- df_jobs %>%
rename(Sector = 1) %>%
select(Sector, `Totalement Exportatrices`, AUTRE) %>%
filter(!is.na(Sector)) %>%
filter(Sector != "Total") %>%
mutate(Sector = trimws(Sector)) %>%
pivot_longer(cols = -Sector, names_to = "Company_Type", values_to = "Jobs") %>%
# KEEP ONLY DIGITS (0-9).
mutate(Jobs = as.numeric(gsub("[^0-9]", "", Jobs)))
# MERGE
stats_data <- final_map_data %>%
group_by(Sector) %>%
summarise(Total_Companies = sum(Companies, na.rm = TRUE)) %>%
left_join(
final_jobs_data %>% group_by(Sector) %>% summarise(Total_Jobs = sum(Jobs, na.rm = TRUE)),
by = "Sector"
)
#VERIFY DATA
print("DATA PREVIEW")
print(head(stats_data))
#Mean & Median
print(paste("Mean Jobs:", round(mean(stats_data$Total_Jobs, na.rm = TRUE), 2)))
print(paste("Median Jobs:", round(median(stats_data$Total_Jobs, na.rm = TRUE), 2)))
#Shapiro-Wilk Test (Normality)
tryCatch({
print("Shapiro-Wilk Test:")
print(shapiro.test(stats_data$Total_Jobs))
}, error = function(e) { print("Shapiro Test Error: Data might still be constant or too small.") })
#Correlation
cor_result <- cor(stats_data$Total_Companies, stats_data$Total_Jobs, use = "complete.obs")
print(paste("Correlation Coefficient:", round(cor_result, 4)))
#Linear Regression
model <- lm(Total_Jobs ~ Total_Companies, data = stats_data)
print("Linear Regression Summary:")
print(summary(model))
#Plot
ggplot(stats_data, aes(x = Total_Companies, y = Total_Jobs)) +
geom_point(color = "darkblue", size = 3) +
geom_smooth(method = "lm", color = "red", se = FALSE) +
theme_minimal() +
labs(title = "Final Model: Investment vs Jobs", x = "Companies", y = "Jobs")
