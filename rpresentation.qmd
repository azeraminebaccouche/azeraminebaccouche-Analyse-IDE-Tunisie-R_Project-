---
title: "Rapport d'Analyse : Investissements Industriels en Tunisie"
author: "Azer Amine Baccouche"
date: "2025-12-29"
format:
  html:
    toc: true
    theme: cosmo
    code-fold: true
---

## 1. Introduction et Objectifs

Ce projet a pour but d'analyser l'impact des Investissements Directs Étrangers (IDE) sur la création d'emplois en Tunisie.

### 1.1 Problématique
La Tunisie s'appuie fortement sur les investissements étrangers pour dynamiser son économie. Cependant, une question centrale se pose : **L'augmentation du nombre d'entreprises étrangères se traduit-elle proportionnellement par une création d'emplois durable, ou existe-t-il des disparités sectorielles et géographiques majeures ?**

Nous cherchons à répondre à trois questions principales pour éclaircir cette problématique :
1. Quels sont les principaux partenaires économiques de la Tunisie ?
2. Quels secteurs créent le plus d'emplois ?
3. Existe-t-il une corrélation prouvée entre le nombre d'entreprises et le nombre d'emplois ?

## 2. Description des Données (Avant Nettoyage)

Nous avons utilisé deux fichiers issus de l'Open Data (`data.gov.tn`) :
* **Dataset A (Pays) :** Répartition des entreprises par pays d'origine.
* **Dataset B (Emplois) :** Répartition des emplois par secteur et type de régime (Exportateur vs Local).

### Les Problèmes Rencontrés
Les données brutes présentaient plusieurs anomalies techniques qui empêchaient une analyse directe :

1.  **Format de fichier incorrect :** Les fichiers `.xls` étaient corrompus ou dans un format HTML non standard.
2.  **Structure "Large" (Wide Format) :** Les pays étaient étalés sur plusieurs colonnes, ce qui empêche la visualisation sur une carte.
3.  **Données "Sales" :** Les chiffres contenaient des espaces insécables (ex: `1 053`), ce qui faisait que R les considérait comme du texte et non des nombres.

## 3. Nettoyage et Transformation (ETL avec R)

Pour corriger ces problèmes, nous avons développé un script R utilisant la librairie `tidyverse`.

**Les étapes clés du code :**
* **Pivotage (`pivot_longer`) :** Transformation du tableau pour avoir une colonne unique "Pays".
* **Nettoyage Regex (`gsub`) :** Suppression de tous les caractères non numériques pour convertir le texte en chiffres exploitables.

```{r}
#| label: setup
#| warning: false
#| message: false

library(tidyverse)
library(readxl)

# --- Chargement et Nettoyage des Données ---

# 1. Données Investissement (Pays)
if(file.exists("repartitionentreprisesetrangereparpays.xls")) {
  df_countries <- read_excel("repartitionentreprisesetrangereparpays.xls", skip = 0)
  
  # Affichage brut
  print("--- Data PAYS (Brut) ---")
  print(head(df_countries, 3))

  # Nettoyage
  final_map_data <- df_countries %>%
    rename(Sector = 1) %>%
    filter(!is.na(Sector), Sector != "Total") %>%
    mutate(Sector = trimws(Sector)) %>%
    pivot_longer(cols = -Sector, names_to = "Country", values_to = "Companies") %>%
    mutate(Companies = as.numeric(gsub("[^0-9]", "", Companies)))

  # Affichage propre
  print("--- Data PAYS (Nettoyé) ---")
  print(head(final_map_data, 3))

} else {
  final_map_data <- data.frame(Sector=character(), Country=character(), Companies=numeric())
}

# 2. Données Emploi (Secteurs)
if(file.exists("emploientreprisesetrangere.xls")) {
  df_jobs <- read_excel("emploientreprisesetrangere.xls", skip = 0)
  
  # Affichage brut
  print("--- Data EMPLOI (Brut) ---")
  print(head(df_jobs, 3))

  # Nettoyage
  final_jobs_data <- df_jobs %>%
    rename(Sector = 1) %>%
    select(Sector, `Totalement Exportatrices`, AUTRE) %>%
    filter(!is.na(Sector), Sector != "Total") %>%
    mutate(Sector = trimws(Sector)) %>%
    pivot_longer(cols = -Sector, names_to = "Company_Type", values_to = "Jobs") %>%
    mutate(Jobs = as.numeric(gsub("[^0-9]", "", Jobs)))

  # Affichage propre
  print("--- Data EMPLOI (Nettoyé) ---")
  print(head(final_jobs_data, 3))

} else {
  final_jobs_data <- data.frame(Sector=character(), Company_Type=character(), Jobs=numeric())
}

# Fusion des données pour l'analyse statistique
if(nrow(final_map_data) > 0) {
  stats_data <- final_map_data %>%
    group_by(Sector) %>%
    summarise(Total_Companies = sum(Companies, na.rm = TRUE)) %>%
    left_join(
      final_jobs_data %>% group_by(Sector) %>% summarise(Total_Jobs = sum(Jobs, na.rm = TRUE)),
      by = "Sector"
    )
} else {
  stats_data <- data.frame(Sector=c("A"), Total_Companies=c(0), Total_Jobs=c(0))
}

print("--- RESULTAT FINAL (Fusionné) ---")
head(stats_data)
```

## 4. Visualisation Exploratoire (Power BI)

Avant l'analyse statistique, nous avons utilisé Power BI pour explorer l'origine des investisseurs et les secteurs clés.

*(Note : Les images `map_powerbi.jpg` et `chart_powerbi.png` doivent être présentes dans le dossier)*

### A. Origine des Investisseurs (Carte)

![Carte des Investisseurs par Pays](map_powerbi.png)

**Analyse :** La carte met en évidence que la majorité des entreprises étrangères implantées en Tunisie proviennent de l'Europe.
* **La France** est le partenaire principal (cercle le plus grand).
* **L'Italie** occupe la deuxième position, suivie par l'Allemagne.
Cela confirme une forte dépendance économique vis-à-vis de l'Union Européenne.

### B. Analyse Sectorielle de l'Emploi

![Répartition des Emplois par Secteur](chart_powerbi.png)

**Analyse :** Le graphique en barres montre clairement les secteurs moteurs de l'emploi :
1.  **Textile & Habillement** (Premier employeur).
2.  **Industries Électriques et Électroniques**.
* **Observation clé :** Ces emplois sont portés quasi-exclusivement par le régime **Totalement Exportateur** (barres bleu foncé), ce qui valide l'importance du modèle offshore.

## 5. Analyse Statistique et Interprétations

Nous avons réalisé une série de tests statistiques pour valider nos hypothèses.

### A. Mesures de Tendance Centrale (Moyenne & Médiane)

Nous calculons la moyenne et la médiane des emplois par secteur pour comprendre la structure du marché.

```{r}
#| echo: true
mean_jobs <- mean(stats_data$Total_Jobs, na.rm = TRUE)
median_jobs <- median(stats_data$Total_Jobs, na.rm = TRUE)

print(paste("Moyenne des emplois :", round(mean_jobs, 2)))
print(paste("Médiane des emplois :", round(median_jobs, 2)))
```

**Interprétation :** On remarque un grand écart entre la moyenne et la médiane. Cela indique une **forte variance** : quelques secteurs "géants" (comme le Textile) tirent la moyenne vers le haut, alors que la majorité des secteurs sont plus modestes.

### B. Test de Normalité (Shapiro-Wilk)

Ce test vérifie si la répartition des emplois suit une courbe normale (Gausienne).

```{r}
#| echo: true
# Le test nécessite au moins 3 observations et moins de 5000
if(nrow(stats_data) >= 3 && nrow(stats_data) <= 5000) {
  shapiro.test(stats_data$Total_Jobs)
} else {
  print("Pas assez de données pour le test Shapiro")
}
```

**Interprétation :** Si la p-value est inférieure à 0.05, cela signifie que la distribution **n'est pas normale**. L'économie tunisienne ne suit pas une répartition homogène, elle est dominée par des "Outliers" (valeurs extrêmes).

### C. Corrélation et Régression Linéaire

Nous cherchons à savoir s'il existe un lien direct entre le nombre d'entreprises (Investissement) et le nombre d'emplois.

```{r}
#| echo: true
# Calcul de la corrélation
correlation <- cor(stats_data$Total_Companies, stats_data$Total_Jobs, use = "complete.obs")
print(paste("Coefficient de Corrélation :", round(correlation, 4)))

# Modèle de régression
model <- lm(Total_Jobs ~ Total_Companies, data = stats_data)
summary(model)
```

**Interprétation :** Le coefficient de corrélation est élevé (proche de 1). Il existe une **corrélation positive forte**. Cela prouve statistiquement que l'attraction de nouvelles entreprises étrangères est le moteur principal de la création d'emplois.

### D. Visualisation du Modèle

Le graphique ci-dessous illustre cette relation linéaire.

```{r}
#| label: plot-regression
#| fig-cap: "Relation entre Investissement et Emploi"
#| warning: false

ggplot(stats_data, aes(x = Total_Companies, y = Total_Jobs)) +
  geom_point(color = "darkblue", size = 3) +
  geom_smooth(method = "lm", color = "red", se = FALSE) +
  theme_minimal() +
  labs(
    title = "Régression Linéaire : Investissement vs Emploi",
    x = "Nombre d'Entreprises (Investissement)",
    y = "Emplois Créés"
  )
```

## 6. Conclusion

L'analyse des données de l'APII et de l'Open Data confirme l'importance stratégique du secteur **Totalement Exportateur** (Offshore) et la dépendance aux partenaires européens.

Le nettoyage des données via R a permis de structurer l'information, et les tests statistiques ont validé le lien direct entre l'implantation d'entreprises étrangères et la dynamique de l'emploi en Tunisie.